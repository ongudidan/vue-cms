import{r as _,B as O,E as G,c as i,o as a,b as e,a as v,u as s,d as f,F as H,p as R,t as b,w as X,y as J,z as K,L as Q,M as W,l as Y,m as Z,n as M,s as j,e as U,j as F,f as k,N,v as B,q as L}from"./app-B4dY5ODa.js";import{G as ee,d as te}from"./vuedraggable.umd-8dmbCHm_.js";import{L as oe}from"./loader-circle-Ch9nBnvV.js";import{c as q}from"./createLucideIcon-B0FBwDqt.js";import{S as se,T as re}from"./trash-2-r5XI-ZbC.js";import{X as ne}from"./x-DzxOueU7.js";/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=q("ChevronDownIcon",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-vue-next v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=q("ChevronUpIcon",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ae={class:"flex gap-6 min-h-[500px]"},ie={class:"w-64 flex-shrink-0 space-y-3"},ue={key:0,class:"flex items-center justify-center py-8"},ce={key:1,class:"space-y-2"},pe=["onClick"],me={class:"text-2xl"},be={class:"text-sm font-medium text-foreground"},fe={key:0,class:"rounded-lg border border-dashed border-sidebar-border bg-muted/30 p-4 text-center"},ge={class:"flex-1 space-y-4"},ve={class:"flex items-center justify-between"},xe={class:"text-xs text-muted-foreground"},he={class:"group rounded-lg border border-sidebar-border bg-card overflow-hidden transition-shadow hover:shadow-md"},ye={class:"flex items-center gap-3 bg-muted/30 px-4 py-3"},ke={type:"button",class:"drag-handle cursor-move text-muted-foreground hover:text-foreground"},_e={class:"flex-1"},we={class:"text-sm font-medium text-foreground"},Ce={class:"flex items-center gap-1"},Se=["onClick"],$e=["onClick"],Ee=["onClick"],Ve=["onClick"],Ue={class:"p-4"},Be={key:1,class:"text-sm text-muted-foreground"},De={key:0,class:"rounded-lg border-2 border-dashed border-sidebar-border bg-muted/30 p-12 text-center"},Me={__name:"PageBuilder",props:{content:{type:Array,default:()=>[]}},emits:["update:content"],setup(S,{emit:E}){const x=S,w=E,d=_([...x.content]),m=_(!1),t=_(null),h=_([]),y=_(!0),$=O({}),c=async()=>{try{y.value=!0;const r=(await Q.get("/api/themes/active/sections")).data.sections||[];for(const n of r)if(n.vueForm)try{const u=`../../${n.vueForm}`,g=W(()=>import(u));$.value[n.type]=g}catch(u){console.warn(`Failed to load component for ${n.type}:`,u)}h.value=r}catch(l){console.error("Failed to fetch theme sections:",l),h.value=[]}finally{y.value=!1}},o=l=>$.value[l]||null,p=l=>{const r={id:`section-${Date.now()}`,type:l,order:d.value.length,data:{}};d.value.push(r),C()},z=l=>{d.value.splice(l,1),V(),C()},I=l=>{t.value=l},T=(l,r)=>{d.value[l].data=r,t.value=null,C()},P=()=>{t.value=null},D=(l,r)=>{const n=r==="up"?l-1:l+1;if(n>=0&&n<d.value.length){const u=d.value[l];d.value[l]=d.value[n],d.value[n]=u,V(),C()}},V=()=>{d.value.forEach((l,r)=>{l.order=r})},A=()=>{m.value=!1,V(),C()},C=()=>{w("update:content",d.value)};return G(()=>{c()}),(l,r)=>(a(),i("div",ae,[e("div",ie,[r[3]||(r[3]=e("h3",{class:"text-sm font-semibold text-foreground mb-3"},"Available Sections",-1)),r[4]||(r[4]=e("p",{class:"text-xs text-muted-foreground mb-4"},"Click to add to your page",-1)),y.value?(a(),i("div",ue,[v(s(oe),{class:"h-6 w-6 animate-spin text-primary"})])):(a(),i("div",ce,[(a(!0),i(H,null,R(h.value,n=>(a(),i("button",{key:n.type,onClick:u=>p(n.type),type:"button",class:"w-full flex items-center gap-3 rounded-lg border border-sidebar-border bg-card p-3 text-left transition-all hover:border-primary hover:shadow-md hover:scale-105"},[e("span",me,b(n.icon),1),e("span",be,b(n.label),1)],8,pe))),128)),h.value.length===0?(a(),i("div",fe,[...r[2]||(r[2]=[e("p",{class:"text-xs text-muted-foreground"}," No theme is active. Please activate a theme first. ",-1)])])):f("",!0)]))]),e("div",ge,[e("div",ve,[r[5]||(r[5]=e("h3",{class:"text-sm font-semibold text-foreground"},"Page Sections",-1)),e("span",xe,b(d.value.length)+" section"+b(d.value.length!==1?"s":""),1)]),v(s(te),{modelValue:d.value,"onUpdate:modelValue":r[0]||(r[0]=n=>d.value=n),onStart:r[1]||(r[1]=n=>m.value=!0),onEnd:A,"item-key":"id",handle:".drag-handle",class:"space-y-3"},{item:X(({element:n,index:u})=>[e("div",he,[e("div",ye,[e("button",ke,[v(s(ee),{class:"h-5 w-5"})]),e("div",_e,[e("span",we,b(h.value.find(g=>g.type===n.type)?.label||n.type),1)]),e("div",Ce,[u>0?(a(),i("button",{key:0,onClick:g=>D(u,"up"),type:"button",class:"rounded p-1 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",title:"Move up"},[v(s(le),{class:"h-4 w-4"})],8,Se)):f("",!0),u<d.value.length-1?(a(),i("button",{key:1,onClick:g=>D(u,"down"),type:"button",class:"rounded p-1 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",title:"Move down"},[v(s(de),{class:"h-4 w-4"})],8,$e)):f("",!0),e("button",{onClick:g=>I(u),type:"button",class:"rounded p-1 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground",title:"Edit"},[v(s(se),{class:"h-4 w-4"})],8,Ee),e("button",{onClick:g=>z(u),type:"button",class:"rounded p-1 text-muted-foreground transition-colors hover:bg-red-100 hover:text-red-600 dark:hover:bg-red-950",title:"Delete"},[v(s(re),{class:"h-4 w-4"})],8,Ve)])]),e("div",Ue,[o(n.type)?(a(),J(K(o(n.type)),{key:0,data:n.data,editing:t.value===u,onSave:g=>T(u,g),onCancel:P},null,40,["data","editing","onSave"])):(a(),i("div",Be," Component not found for "+b(n.type),1))])])]),_:1},8,["modelValue"]),d.value.length===0?(a(),i("div",De,[...r[6]||(r[6]=[e("p",{class:"text-sm text-muted-foreground"},"No sections yet. Click a section type from the left sidebar to add it to your page.",-1)])])):f("",!0)])]))}},je={class:"w-full max-w-[98vw] max-h-[95vh] overflow-y-auto rounded-xl border border-sidebar-border bg-card shadow-xl"},Fe={class:"sticky top-0 z-10 flex items-center justify-between border-b border-sidebar-border bg-card px-6 py-4"},Ne={class:"text-xl font-semibold text-foreground"},Le={class:"border-b border-sidebar-border bg-muted/30 px-6"},qe={class:"flex gap-4"},ze={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"},Ie={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-primary"},Te={class:"space-y-4"},Pe={key:0,class:"mt-1 text-xs text-red-600 dark:text-red-400"},Ae={key:0,class:"mt-1 text-xs text-red-600 dark:text-red-400"},Oe={key:0,class:"mt-1 text-xs text-red-600 dark:text-red-400"},Ge={class:"flex items-center gap-3"},He={class:"flex items-center gap-3"},Re={class:"mt-6 flex justify-end gap-3 border-t border-sidebar-border pt-6"},Xe=["disabled"],Je=["disabled"],tt={__name:"PageModal",props:{show:{type:Boolean,required:!0},page:{type:Object,default:null}},emits:["close"],setup(S,{emit:E}){const x=S,w=E,d=Y(()=>!!x.page),m=_("basic"),t=Z({title:"",slug:"",description:"",content:[],published:!1,is_homepage:!1});M(()=>x.page,c=>{c?(t.title=c.title,t.slug=c.slug||"",t.description=c.description||"",t.content=c.content||[],t.published=c.published||!1,t.is_homepage=c.is_homepage||!1):t.reset()},{immediate:!0}),M(()=>x.show,c=>{c||(t.reset(),t.clearErrors(),m.value="basic")});const h=()=>{d.value&&x.page?t.put(`/admin/pages/${x.page.id}`,{preserveScroll:!0,onSuccess:()=>w("close")}):t.post("/admin/pages",{preserveScroll:!0,onSuccess:()=>w("close")})},y=()=>w("close"),$=c=>{t.content=c};return(c,o)=>S.show?(a(),i("div",{key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-2",onClick:F(y,["self"])},[e("div",je,[e("div",Fe,[e("h2",Ne,b(d.value?"Edit Page":"Create Page"),1),e("button",{onClick:y,class:"rounded-lg p-2 text-muted-foreground transition-colors hover:bg-muted hover:text-foreground"},[v(s(ne),{class:"h-5 w-5"})])]),e("div",Le,[e("div",qe,[e("button",{onClick:o[0]||(o[0]=p=>m.value="basic"),class:j(["relative px-4 py-3 text-sm font-medium transition-colors",m.value==="basic"?"text-primary":"text-muted-foreground hover:text-foreground"])},[o[7]||(o[7]=U(" Basic Information ",-1)),m.value==="basic"?(a(),i("div",ze)):f("",!0)],2),e("button",{onClick:o[1]||(o[1]=p=>m.value="builder"),class:j(["relative px-4 py-3 text-sm font-medium transition-colors",m.value==="builder"?"text-primary":"text-muted-foreground hover:text-foreground"])},[o[8]||(o[8]=U(" Page Builder ",-1)),m.value==="builder"?(a(),i("div",Ie)):f("",!0)],2)])]),e("form",{onSubmit:F(h,["prevent"]),class:"p-6"},[k(e("div",Te,[e("div",null,[o[9]||(o[9]=e("label",{for:"title",class:"mb-1.5 block text-sm font-medium text-foreground"},[U(" Title "),e("span",{class:"text-red-500"},"*")],-1)),k(e("input",{id:"title","onUpdate:modelValue":o[2]||(o[2]=p=>s(t).title=p),type:"text",required:"",class:"w-full rounded-lg border border-sidebar-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"Enter page title"},null,512),[[B,s(t).title]]),s(t).errors.title?(a(),i("p",Pe,b(s(t).errors.title),1)):f("",!0)]),e("div",null,[o[10]||(o[10]=e("label",{for:"slug",class:"mb-1.5 block text-sm font-medium text-foreground"}," Slug ",-1)),k(e("input",{id:"slug","onUpdate:modelValue":o[3]||(o[3]=p=>s(t).slug=p),type:"text",class:"w-full rounded-lg border border-sidebar-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"auto-generated-from-title"},null,512),[[B,s(t).slug]]),o[11]||(o[11]=e("p",{class:"mt-1 text-xs text-muted-foreground"}," Leave empty to auto-generate from title ",-1)),s(t).errors.slug?(a(),i("p",Ae,b(s(t).errors.slug),1)):f("",!0)]),e("div",null,[o[12]||(o[12]=e("label",{for:"description",class:"mb-1.5 block text-sm font-medium text-foreground"}," Description ",-1)),k(e("textarea",{id:"description","onUpdate:modelValue":o[4]||(o[4]=p=>s(t).description=p),rows:"3",class:"w-full rounded-lg border border-sidebar-border bg-background px-3 py-2 text-sm text-foreground placeholder:text-muted-foreground focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",placeholder:"Enter page description (for SEO)"},null,512),[[B,s(t).description]]),s(t).errors.description?(a(),i("p",Oe,b(s(t).errors.description),1)):f("",!0)]),e("div",Ge,[k(e("input",{id:"published","onUpdate:modelValue":o[5]||(o[5]=p=>s(t).published=p),type:"checkbox",class:"h-4 w-4 rounded border-sidebar-border text-primary focus:ring-2 focus:ring-primary/20"},null,512),[[L,s(t).published]]),o[13]||(o[13]=e("label",{for:"published",class:"text-sm font-medium text-foreground"}," Published ",-1))]),e("div",He,[k(e("input",{id:"is_homepage","onUpdate:modelValue":o[6]||(o[6]=p=>s(t).is_homepage=p),type:"checkbox",class:"h-4 w-4 rounded border-sidebar-border text-primary focus:ring-2 focus:ring-primary/20"},null,512),[[L,s(t).is_homepage]]),o[14]||(o[14]=e("label",{for:"is_homepage",class:"text-sm font-medium text-foreground"}," Set as Homepage ",-1))])],512),[[N,m.value==="basic"]]),k(e("div",null,[v(Me,{content:s(t).content,"onUpdate:content":$},null,8,["content"])],512),[[N,m.value==="builder"]]),e("div",Re,[e("button",{type:"button",onClick:y,class:"rounded-lg border border-sidebar-border px-4 py-2 text-sm font-medium text-foreground transition-colors hover:bg-muted",disabled:s(t).processing}," Cancel ",8,Xe),e("button",{type:"submit",class:"rounded-lg bg-primary px-4 py-2 text-sm font-medium text-primary-foreground shadow-sm transition-all hover:bg-primary/90 hover:shadow-md disabled:cursor-not-allowed disabled:opacity-50",disabled:s(t).processing},b(s(t).processing?"Saving...":d.value?"Update":"Create"),9,Je)])],32)])])):f("",!0)}};export{tt as default};
